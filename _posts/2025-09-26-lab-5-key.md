---
layout: post
title:  "Lab 5: KEY"
date:   2025-09-26
assigned: 2025-09-26
due: 2025-10-02
categories: activities http requests python keys
published: true
---

This page contains the information for *{{ page.title }}*.

## Python Requests Lab

### 1 & 2. URL / URI Formulation

Answers for the first two questions are summarized in the table below.
The questions asked you to 1) identify URIs based on resource IDs, 2) to identify LCCNs, and 3) to create permalinks for three items.
These are as follows:

| No. | Resource ID             | Resource page | LCCN       | permalink |
| 1.  | /resource/cph.3f05183/  | [https://www.loc.gov/resource/cph.3f05183/](https://www.loc.gov/resource/cph.3f05183/) | 98508155   | [https://lccn.loc.gov/98508155](https://lccn.loc.gov/98508155) |
| 2.  | /resource/fsa.8d24709/  | [https://www.loc.gov/resource/fsa.8d24709/](https://www.loc.gov/resource/fsa.8d24709/) | 2017843202 | [https://lccn.loc.gov/2017843202](https://lccn.loc.gov/2017843202) |
| 3.  | /resource/highsm.64003/ | [https://www.loc.gov/resource/highsm.64003/](https://www.loc.gov/resource/highsm.64003/) | 2020722343 | [https://lccn.loc.gov/2020722343](https://lccn.loc.gov/2020722343) |

### 3. Retrieve JSON data for items

This question asks you to use a programmatic approach to the above to gather and save the item metadata for each of the three items. At this stage it may not be required to create a function
to do this, but you should be starting to think of this as a repeatable process.
Therefore, two solutions are offered here. 

**Solution with basic python.** This could be saved in a `.py` file that would
write the `.json` files locally. This approach uses the resource identifiers
in a list that allows the script to request the JSON and save it locally for each resource:

```python
import requests
import json

baseURL = 'https://www.loc.gov'
parameters = {'fo':'json'}
items = ['/resource/cph.3f05183/', '/resource/fsa.8d24709/', '/resource/highsm.64003/']

for item in items:
    r = requests.get(baseURL + item, params = parameters)
    fname = item.split('/')[-2] + '.json'
    json_data = r.json()
    with open(fname, 'w', encoding='utf-8') as f:
        f.write(json.dumps(json_data, indent=2))
```

**Solution with a python function.** This approach is similar but
creates a function, which would be a potentially reusable element if you were
expecting to request json like this frequently.

```python
import requests
import json

# Define a function
def get_loc_items_with_resource_id_list(url, item, response_form):
    r = requests.get(url + item, params = {'fo' : response_form})
    fname = item.split('/')[-2] + '.json'
    json_data = r.json()
    with open(fname, 'w', encoding='utf-8') as f:
        f.write(json.dumps(json_data, indent=2))

# Run the function
baseURL = 'https://www.loc.gov'
items = ['/resource/cph.3f05183/', '/resource/fsa.8d24709/', '/resource/highsm.64003/']

for item in items:
    get_loc_items_with_resource_id_list(baseURL, item, 'json')
```

### 4. Use a different parameter

Assume that the `https://www.loc.gov/search` address at the LOC can receive search requests by appending the parameter `q` to the URL.
This is a way to send a search query automatically via the URL (think of the variable `q` for "query").
Create a short block of Python code that queries the base URL.
Use the `input()` function so the code will ask the user for a unique query,
save that query as a string that will be inserted into the URI request as a parameter,
send the request using python requests,
and return the results.
The script should print out the results to the terminal or in the Jupyter notebook.
(In a production environment you would likely want to display such results in a browser or perhaps save them in a JSON file.)

```python
import requests

baseURL = 'https://www.loc.gov/'
endpoint = 'search'
query = input('Please type your search query: ')
parameters = {'q':query}

r = requests.get(baseURL + endpoint, params=parameters)

with open('search-response-' + query + '.html', 'w', encoding='utf-8') as f:
    f.write(r.text)
```

All materials should be turned in via canvas at the link below.

## Resources

* [Assignment page on canvas][canvas-link]

[canvas-link]: https://umich.instructure.com/courses/698670/assignments/2515067
